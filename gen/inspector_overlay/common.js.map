{"version":3,"file":"common.js","sourceRoot":"","sources":["../../../../inspector_overlay/common.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2019 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nexport type PathCommands = Array<string|number>;\n\nexport interface Quad {\n  p1: Position;\n  p2: Position;\n  p3: Position;\n  p4: Position;\n}\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\nexport interface Bounds {\n  minX: number;\n  maxX: number;\n  minY: number;\n  maxY: number;\n  width?: number;\n  height?: number;\n  allPoints: Position[];\n}\n\nexport interface AreaBounds {\n  name: string;\n  bounds: {allPoints: Position[]};\n}\n\ninterface ViewportSize {\n  width: number;\n  height: number;\n}\n\nexport interface ResetData {\n  viewportSize: ViewportSize;\n  viewportSizeForMediaQueries?: ViewportSize;\n  deviceScaleFactor: number;\n  pageScaleFactor: number;\n  pageZoomFactor: number;\n  emulationScaleFactor: number;\n  scrollX: number;\n  scrollY: number;\n}\n\n// Overlay class should be used to implement various tools and provide\n// access to globals via the window object it receives in the constructor.\n// Old logic is kept temporarily while the tools are being migrated.\nexport class Overlay {\n  protected viewportSize = {width: 800, height: 600};\n  protected viewportSizeForMediaQueries?: ViewportSize;\n  protected deviceScaleFactor = 1;\n  protected emulationScaleFactor = 1;\n  protected pageScaleFactor = 1;\n  protected pageZoomFactor = 1;\n  protected scrollX = 0;\n  protected scrollY = 0;\n  protected style: CSSStyleSheet[];\n  protected canvas?: HTMLCanvasElement;\n  protected canvasWidth: number = 0;\n  protected canvasHeight: number = 0;\n  protected platform?: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  private _window?: Window;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  private _document?: Document;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  private _context?: CanvasRenderingContext2D|null;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  private _installed = false;\n\n  constructor(window: Window, style: CSSStyleSheet[] = []) {\n    this._window = window;\n    this._document = window.document;\n    if (!Array.isArray(style)) {\n      style = [style];\n    }\n    this.style = style;\n  }\n\n  setCanvas(canvas: HTMLCanvasElement) {\n    this.canvas = canvas;\n    this._context = canvas.getContext('2d');\n  }\n\n  install() {\n    for (const style of this.style) {\n      adoptStyleSheet(style);\n    }\n    this._installed = true;\n  }\n\n  uninstall() {\n    for (const style of this.style) {\n      document.adoptedStyleSheets = document.adoptedStyleSheets.filter(s => s !== style);\n    }\n    this._installed = false;\n  }\n\n  reset(resetData?: ResetData) {\n    if (resetData) {\n      this.viewportSize = resetData.viewportSize;\n      this.viewportSizeForMediaQueries = resetData.viewportSizeForMediaQueries;\n      this.deviceScaleFactor = resetData.deviceScaleFactor;\n      this.pageScaleFactor = resetData.pageScaleFactor;\n      this.pageZoomFactor = resetData.pageZoomFactor;\n      this.emulationScaleFactor = resetData.emulationScaleFactor;\n      this.scrollX = Math.round(resetData.scrollX);\n      this.scrollY = Math.round(resetData.scrollY);\n    }\n    this.resetCanvas();\n  }\n\n  resetCanvas() {\n    if (!this.canvas || !this._context) {\n      return;\n    }\n\n    this.canvas.width = this.deviceScaleFactor * this.viewportSize.width;\n    this.canvas.height = this.deviceScaleFactor * this.viewportSize.height;\n    this.canvas.style.width = this.viewportSize.width + 'px';\n    this.canvas.style.height = this.viewportSize.height + 'px';\n\n    this._context.scale(this.deviceScaleFactor, this.deviceScaleFactor);\n\n    this.canvasWidth = this.viewportSize.width;\n    this.canvasHeight = this.viewportSize.height;\n  }\n\n  setPlatform(platform: string) {\n    this.platform = platform;\n    this.document.body.classList.add('platform-' + platform);\n    if (!this._installed) {\n      this.install();\n    }\n  }\n\n  dispatch(message: unknown[]) {\n    const functionName = message.shift() as string;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (this as any)[functionName].apply(this, message);\n  }\n\n  eventHasCtrlOrMeta(event: KeyboardEvent) {\n    return this.platform === 'mac' ? (event.metaKey && !event.ctrlKey) : (event.ctrlKey && !event.metaKey);\n  }\n\n  get context(): CanvasRenderingContext2D {\n    if (!this._context) {\n      throw new Error('Context object is missing');\n    }\n    return this._context;\n  }\n\n  get document(): Document {\n    if (!this._document) {\n      throw new Error('Document object is missing');\n    }\n    return this._document;\n  }\n\n  get window(): Window {\n    if (!this._window) {\n      throw new Error('Window object is missing');\n    }\n    return this._window;\n  }\n\n  get installed(): boolean {\n    return this._installed;\n  }\n}\n\nexport function log(text: string) {\n  let element = document.getElementById('log');\n  if (!element) {\n    element = createChild(document.body, 'div');\n    element.id = 'log';\n  }\n  createChild(element, 'div').textContent = text;\n}\n\nexport function createChild(parent: HTMLElement, tagName: string, className?: string): HTMLElement {\n  const element = createElement(tagName, className);\n  element.addEventListener('click', function(e: Event) {\n    e.stopPropagation();\n  }, false);\n  parent.appendChild(element);\n  return element;\n}\n\nexport function createTextChild(parent: HTMLElement, text: string): Text {\n  const element = document.createTextNode(text);\n  parent.appendChild(element);\n  return element;\n}\n\nexport function createElement(tagName: string, className?: string) {\n  const element = document.createElement(tagName);\n  if (className) {\n    element.className = className;\n  }\n  return element;\n}\n\nexport function ellipsify(str: string, maxLength: number) {\n  if (str.length <= maxLength) {\n    return String(str);\n  }\n  return str.substr(0, maxLength - 1) + '\\u2026';\n}\n\nexport function constrainNumber(num: number, min: number, max: number): number {\n  if (num < min) {\n    num = min;\n  } else if (num > max) {\n    num = max;\n  }\n  return num;\n}\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  interface Document {\n    adoptedStyleSheets: CSSStyleSheet[];\n  }\n}\n\nexport function adoptStyleSheet(styleSheet: CSSStyleSheet) {\n  document.adoptedStyleSheets = [...document.adoptedStyleSheets, styleSheet];\n}\n"]}