{"version":3,"file":"text_editor_test.js","sourceRoot":"","sources":["../../../../../../test/interactions/text_editor/text_editor_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {click, pressKey, typeText, waitFor} from '../../shared/helper.js';\nimport {it} from '../../shared/mocha-extensions.js';\nimport {loadComponentDocExample, preloadForCodeCoverage} from '../helpers/shared.js';\n\nimport type {ElementHandle} from 'puppeteer';\nimport type * as TextEditor from '../../../front_end/ui/components/text_editor/text_editor.js';\n\nasync function getEditorContent(textEditor: ElementHandle): Promise<string> {\n  return textEditor.evaluate(node => (node as TextEditor.TextEditor.TextEditor).state.doc.toString());\n}\n\nasync function getEditorSelection(textEditor: ElementHandle): Promise<{anchor: number, head: number}> {\n  return JSON.parse(await textEditor.evaluate(node => {\n    const {anchor, head} = (node as TextEditor.TextEditor.TextEditor).state.selection.main;\n    return JSON.stringify({anchor, head});\n  }));\n}\n\ndescribe('text editor', async () => {\n  preloadForCodeCoverage('text_editor/basic.html');\n\n  it('can insert and delete some text', async () => {\n    await loadComponentDocExample('text_editor/basic.html');\n    const textEditor = await waitFor('devtools-text-editor');\n\n    await click('.cm-content', {root: textEditor});\n    await typeText('Some text here');\n\n    assert.strictEqual(await getEditorContent(textEditor), 'Some text here');\n\n    await pressKey('Backspace');\n    await pressKey('Backspace');\n\n    assert.strictEqual(await getEditorContent(textEditor), 'Some text he');\n  });\n\n  it('binds the expected keys', async () => {\n    await loadComponentDocExample('text_editor/basic.html');\n    const textEditor = await waitFor('devtools-text-editor');\n\n    await click('.cm-content', {root: textEditor});\n    await typeText('one two');\n    const ctrlOrAlt = process.platform === 'darwin' ? {alt: true} : {control: true};\n\n    await pressKey('ArrowLeft');\n    assert.strictEqual((await getEditorSelection(textEditor)).head, 6);\n    await pressKey('ArrowLeft', ctrlOrAlt);\n    assert.strictEqual((await getEditorSelection(textEditor)).head, 4);\n    await pressKey('Home');\n    assert.strictEqual((await getEditorSelection(textEditor)).head, 0);\n\n    await pressKey('ArrowRight');\n    assert.strictEqual((await getEditorSelection(textEditor)).head, 1);\n    await pressKey('ArrowRight', ctrlOrAlt);\n    assert.strictEqual((await getEditorSelection(textEditor)).head, 3);\n    await pressKey('End', {control: true});\n    assert.strictEqual((await getEditorSelection(textEditor)).head, 7);\n\n    await typeText(' three');\n    assert.strictEqual(await getEditorContent(textEditor), 'one two three');\n    await pressKey('Z', {control: true});\n    assert.strictEqual(await getEditorContent(textEditor), 'one two');\n    await pressKey('Z', {control: true});\n    assert.strictEqual(await getEditorContent(textEditor), '');\n  });\n});\n"]}