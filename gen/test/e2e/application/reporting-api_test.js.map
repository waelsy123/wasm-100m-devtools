{"version":3,"file":"reporting-api_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/application/reporting-api_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {$, click, enableExperiment, getBrowserAndPages, getTestServerPort, goToResource, waitFor} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {navigateToApplicationTab} from '../helpers/application-helpers.js';\nimport {getDataGrid, getDataGridRows, getInnerTextOfDataGridCells} from '../helpers/datagrid-helpers.js';\n\nconst REPORTING_API_SELECTOR = '[aria-label=\"Reporting API\"]';\n\ndescribe('The Reporting API Page', async () => {\n  beforeEach(async () => {\n    await enableExperiment('reportingApiDebugging');\n  });\n\n  it('shows reports', async () => {\n    const {target} = getBrowserAndPages();\n    await navigateToApplicationTab(target, 'reporting-api');\n    await click(REPORTING_API_SELECTOR);\n    const dataGrid = await getDataGrid();\n    const innerText = await getInnerTextOfDataGridCells(dataGrid, 1, false);\n    const reportBody = '{\"columnNumber\":10,\"id\":\"PrefixedStorageInfo\",\"lineNumber\":9,\"message\":\"' +\n        '\\'window.webkitStorageInfo\\' is deprecated. Please use \\'navigator.webkitTemporaryStorage\\' or ' +\n        '\\'navigator.webkitPersistentStorage\\' instead.\",\"sourceFile\":' +\n        `\"https://localhost:${getTestServerPort()}/test/e2e/resources/application/reporting-api.html\"}`;\n\n    assert.strictEqual(\n        innerText[0][0], `https://localhost:${getTestServerPort()}/test/e2e/resources/application/reporting-api.html`);\n    assert.strictEqual(innerText[0][1], 'deprecation');\n    assert.strictEqual(innerText[0][2], 'Queued');\n    assert.strictEqual(innerText[0][3], 'default');\n    assert.strictEqual(innerText[0][5], reportBody);\n\n    const rows = await getDataGridRows(1, dataGrid, false);\n    await click(rows[rows.length - 1][0]);\n\n    const jsonView = await waitFor('.json-view');\n    const jsonViewText = await jsonView.evaluate(el => (el as HTMLElement).innerText);\n    assert.strictEqual(jsonViewText, '{columnNumber: 10, id: \"PrefixedStorageInfo\", lineNumber: 9,â€¦}');\n  });\n\n  it('shows endpoints', async () => {\n    await goToResource('application/reporting-api.rawresponse');\n    await click('#tab-resources');\n    await waitFor('.storage-group-list-item');  // Make sure the application navigation list is shown\n    await click(REPORTING_API_SELECTOR);\n    const endpointsGrid = await $('devtools-resources-endpoints-grid');\n    if (!endpointsGrid) {\n      assert.fail('Could not find data-grid');\n    }\n    const dataGrid = await getDataGrid(endpointsGrid);\n    const innerText = await getInnerTextOfDataGridCells(dataGrid, 2, true);\n    assert.strictEqual(innerText[0][0], `https://localhost:${getTestServerPort()}`);\n    assert.strictEqual(innerText[0][1], 'default');\n    assert.strictEqual(innerText[0][2], 'https://reports.example/default');\n    assert.strictEqual(innerText[1][0], `https://localhost:${getTestServerPort()}`);\n    assert.strictEqual(innerText[1][1], 'main-endpoint');\n    assert.strictEqual(innerText[1][2], 'https://reports.example/main');\n  });\n});\n"]}