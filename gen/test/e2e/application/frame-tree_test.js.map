{"version":3,"file":"frame-tree_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/application/frame-tree_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {$$, click, getBrowserAndPages, getTestServerPort, goToResource, pressKey, waitFor, waitForFunction} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {doubleClickSourceTreeItem, getFrameTreeTitles, getTrimmedTextContent, navigateToApplicationTab} from '../helpers/application-helpers.js';\n\nconst TOP_FRAME_SELECTOR = '[aria-label=\"top\"]';\nconst WEB_WORKERS_SELECTOR = '[aria-label=\"Web Workers\"]';\nconst SERVICE_WORKERS_SELECTOR = '[aria-label=\"top\"] ~ ol [aria-label=\"Service Workers\"]';\nconst OPENED_WINDOWS_SELECTOR = '[aria-label=\"Opened Windows\"]';\nconst IFRAME_FRAME_ID_SELECTOR = '[aria-label=\"frameId (iframe.html)\"]';\nconst MAIN_FRAME_SELECTOR = '[aria-label=\"frameId (main-frame.html)\"]';\nconst IFRAME_SELECTOR = '[aria-label=\"iframe.html\"]';\nconst EXPAND_STACKTRACE_BUTTON_SELECTOR = '.arrow-icon-button';\nconst STACKTRACE_ROW_SELECTOR = '.stack-trace-row';\nconst APPLICATION_PANEL_SELECTED_SELECTOR = '.tabbed-pane-header-tab.selected[aria-label=\"Application\"]';\n\nconst getTrailingURL = (text: string): string => {\n  const match = text.match(/http.*$/);\n  return match ? match[0] : '';\n};\n\nconst ensureApplicationPanel = async () => {\n  if ((await $$(APPLICATION_PANEL_SELECTED_SELECTOR)).length === 0) {\n    await waitForFunction(async () => {\n      await click('#tab-resources');\n      return (await $$(APPLICATION_PANEL_SELECTED_SELECTOR)).length === 1;\n    });\n  }\n};\n\ndeclare global {\n  interface Window {\n    iFrameWindow: Window|null|undefined;\n  }\n}\ndescribe('[crbug.com/12]: The Application Tab', async () => {\n  afterEach(async () => {\n    const {target} = getBrowserAndPages();\n    await target.evaluate(async () => {\n      const registrations = await navigator.serviceWorker.getRegistrations();\n      for (const registration of registrations) {\n        void registration.unregister();\n      }\n    });\n  });\n\n  // Update and reactivate when the whole FrameDetailsView is a custom component\n  it('shows details for a frame when clicked on in the frame tree', async () => {\n    const {target} = getBrowserAndPages();\n    await navigateToApplicationTab(target, 'frame-tree');\n    await click('#tab-resources');\n    await doubleClickSourceTreeItem(TOP_FRAME_SELECTOR);\n\n    const fieldValuesTextContent = await waitForFunction(async () => {\n      const fieldValues = await getTrimmedTextContent('devtools-report-value');\n      if (fieldValues[0]) {\n        // This contains some CSS from the svg icon link being rendered. It's\n        // system-specific, so we get rid of it and only look at the (URL) text.\n        fieldValues[0] = getTrailingURL(fieldValues[0]);\n      }\n      if (fieldValues[9] && fieldValues[9].includes('accelerometer')) {\n        fieldValues[9] = 'accelerometer';\n      }\n      // Make sure the length is equivalent to the expected value below\n      if (fieldValues.length === 10) {\n        return fieldValues;\n      }\n      return undefined;\n    });\n    const expected = [\n      `https://localhost:${getTestServerPort()}/test/e2e/resources/application/frame-tree.html`,\n      `https://localhost:${getTestServerPort()}`,\n      '<#document>',\n      'Yes\\xA0Localhost is always a secure context',\n      'No',\n      'None',\n      'UnsafeNone',\n      'unavailable\\xA0requires cross-origin isolated context',\n      'unavailable\\xA0Learn more',\n      'accelerometer',\n    ];\n\n    assert.deepEqual(fieldValuesTextContent, expected);\n  });\n\n  it('shows stack traces for OOPIF', async () => {\n    await goToResource('application/js-oopif.html');\n    await ensureApplicationPanel();\n    await waitForFunction(async () => {\n      await doubleClickSourceTreeItem(TOP_FRAME_SELECTOR);\n      await doubleClickSourceTreeItem(IFRAME_SELECTOR);\n      return (await $$(EXPAND_STACKTRACE_BUTTON_SELECTOR)).length === 1;\n    });\n    const stackTraceRowsTextContent = await waitForFunction(async () => {\n      await ensureApplicationPanel();\n      await click(EXPAND_STACKTRACE_BUTTON_SELECTOR);\n      const stackTraceRows = await getTrimmedTextContent(STACKTRACE_ROW_SELECTOR);\n      // Make sure the length is equivalent to the expected value below\n      if (stackTraceRows.length === 3) {\n        return stackTraceRows;\n      }\n      return undefined;\n    });\n    const expected = [\n      'second\\xA0@\\xA0js-oopif.html:17',\n      'first\\xA0@\\xA0js-oopif.html:11',\n      '(anonymous)\\xA0@\\xA0js-oopif.html:20',\n    ];\n    assert.deepEqual(stackTraceRowsTextContent, expected);\n  });\n\n  it('shows details for opened windows in the frame tree', async () => {\n    const {target} = getBrowserAndPages();\n    await navigateToApplicationTab(target, 'frame-tree');\n    await click('#tab-resources');\n    await doubleClickSourceTreeItem(TOP_FRAME_SELECTOR);\n\n    await target.evaluate(() => {\n      window.iFrameWindow = window.open('iframe.html');\n    });\n\n    await doubleClickSourceTreeItem(OPENED_WINDOWS_SELECTOR);\n    await waitFor(`${OPENED_WINDOWS_SELECTOR} + ol li:first-child`);\n    void pressKey('ArrowDown');\n\n    const fieldValuesTextContent = await waitForFunction(async () => {\n      const fieldValues = await getTrimmedTextContent('.report-field-value');\n      // Make sure the length is equivalent to the expected value below\n      if (fieldValues.length === 3) {\n        return fieldValues;\n      }\n      return undefined;\n    });\n    const expected = [\n      `https://localhost:${getTestServerPort()}/test/e2e/resources/application/iframe.html`,\n      '<#document>',\n      'Yes',\n    ];\n    assert.deepEqual(fieldValuesTextContent, expected);\n    await target.evaluate(() => {\n      window.iFrameWindow?.close();\n    });\n  });\n\n  it('shows dedicated workers in the frame tree', async () => {\n    const {target} = getBrowserAndPages();\n    await goToResource('application/frame-tree.html');\n    await click('#tab-resources');\n    await doubleClickSourceTreeItem(TOP_FRAME_SELECTOR);\n    // DevTools is not ready yet when the worker is being initially attached.\n    // We therefore need to reload the page to see the worker in DevTools.\n    await target.reload();\n    await doubleClickSourceTreeItem(WEB_WORKERS_SELECTOR);\n    await waitFor(`${WEB_WORKERS_SELECTOR} + ol li:first-child`);\n    void pressKey('ArrowDown');\n\n    const fieldValuesTextContent = await waitForFunction(async () => {\n      const fieldValues = await getTrimmedTextContent('.report-field-value');\n      // Make sure the length is equivalent to the expected value below\n      if (fieldValues.length === 3) {\n        return fieldValues;\n      }\n      return undefined;\n    });\n    const expected = [\n      `https://localhost:${getTestServerPort()}/test/e2e/resources/application/dedicated-worker.js`,\n      'Web Worker',\n      'None',\n    ];\n    assert.deepEqual(fieldValuesTextContent, expected);\n  });\n\n  // Flaky test\n  it.skipOnPlatforms(['win32', 'mac'], '[crbug.com/1231056]: shows service workers in the frame tree', async () => {\n    await goToResource('application/service-worker-network.html');\n    await click('#tab-resources');\n    await doubleClickSourceTreeItem(TOP_FRAME_SELECTOR);\n    await doubleClickSourceTreeItem(SERVICE_WORKERS_SELECTOR);\n    await waitFor(`${SERVICE_WORKERS_SELECTOR} + ol li:first-child`);\n    void pressKey('ArrowDown');\n\n    const fieldValuesTextContent = await waitForFunction(async () => {\n      const fieldValues = await getTrimmedTextContent('.report-field-value');\n      // Make sure the length is equivalent to the expected value below\n      if (fieldValues.length === 3) {\n        return fieldValues;\n      }\n      return undefined;\n    });\n    const expected = [\n      `https://localhost:${getTestServerPort()}/test/e2e/resources/application/service-worker.js`,\n      'Service Worker',\n      'None',\n    ];\n    assert.deepEqual(fieldValuesTextContent, expected);\n  });\n\n  // Update and reactivate when the whole FrameDetailsView is a custom component\n  it('can handle when JS writes to frame', async () => {\n    const {target} = getBrowserAndPages();\n    await goToResource('application/main-frame.html');\n    await click('#tab-resources');\n    await doubleClickSourceTreeItem(TOP_FRAME_SELECTOR);\n    await doubleClickSourceTreeItem(IFRAME_FRAME_ID_SELECTOR);\n\n    // check iframe's URL after pageload\n    const fieldValuesTextContent = await waitForFunction(async () => {\n      const fieldValues = await getTrimmedTextContent('devtools-report-value');\n      if (fieldValues[0]) {\n        // This contains some CSS from the svg icon link being rendered. It's\n        // system-specific, so we get rid of it and only look at the (URL) text.\n        fieldValues[0] = getTrailingURL(fieldValues[0]);\n      }\n      if (fieldValues[9] && fieldValues[9].includes('accelerometer')) {\n        fieldValues[9] = 'accelerometer';\n      }\n      // Make sure the length is equivalent to the expected value below\n      if (fieldValues.length === 10) {\n        return fieldValues;\n      }\n      return undefined;\n    });\n    const expected = [\n      `https://localhost:${getTestServerPort()}/test/e2e/resources/application/iframe.html`,\n      `https://localhost:${getTestServerPort()}`,\n      '<iframe>',\n      'Yes\\xA0Localhost is always a secure context',\n      'No',\n      'None',\n      'UnsafeNone',\n      'unavailable\\xA0requires cross-origin isolated context',\n      'unavailable\\xA0Learn more',\n      'accelerometer',\n    ];\n    assert.deepEqual(fieldValuesTextContent, expected);\n\n    assert.deepEqual(await getFrameTreeTitles(), ['top', 'frameId (iframe.html)', 'iframe.html', 'main-frame.html']);\n\n    // write to the iframe using 'document.write()'\n    await target.evaluate(() => {\n      const frame = document.getElementById('frameId') as HTMLIFrameElement;\n      const doc = frame.contentDocument;\n      if (doc) {\n        doc.open();\n        doc.write('<h1>Hello world !</h1>');\n        doc.close();\n      }\n    });\n\n    // check that iframe's URL has changed\n    await doubleClickSourceTreeItem(MAIN_FRAME_SELECTOR);\n    const fieldValuesTextContent2 = await waitForFunction(async () => {\n      const fieldValues = await getTrimmedTextContent('devtools-report-value');\n      if (fieldValues[0]) {\n        fieldValues[0] = getTrailingURL(fieldValues[0]);\n      }\n      if (fieldValues[9] && fieldValues[9].includes('accelerometer')) {\n        fieldValues[9] = 'accelerometer';\n      }\n      // Make sure the length is equivalent to the expected value below\n      if (fieldValues.length === 10) {\n        return fieldValues;\n      }\n      return undefined;\n    });\n    const expected2 = [\n      `https://localhost:${getTestServerPort()}/test/e2e/resources/application/main-frame.html`,\n      `https://localhost:${getTestServerPort()}`,\n      '<iframe>',\n      'Yes\\xA0Localhost is always a secure context',\n      'No',\n      'None',\n      'UnsafeNone',\n      'unavailable\\xA0requires cross-origin isolated context',\n      'unavailable\\xA0Learn more',\n      'accelerometer',\n    ];\n    assert.deepEqual(fieldValuesTextContent2, expected2);\n\n    assert.deepEqual(\n        await getFrameTreeTitles(), ['top', 'frameId (main-frame.html)', 'Document not available', 'main-frame.html']);\n  });\n});\n"]}