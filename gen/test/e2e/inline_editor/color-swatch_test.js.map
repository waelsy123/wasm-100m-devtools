{"version":3,"file":"color-swatch_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/inline_editor/color-swatch_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\nimport type * as puppeteer from 'puppeteer';\n\nimport {goToResource} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {clickNthChildOfSelectedElementNode, editCSSProperty, getColorSwatch, getColorSwatchColor, getCSSPropertyInRule, getPropertyFromComputedPane, navigateToSidePane, shiftClickColorSwatch, waitForContentOfSelectedElementsNode, waitForCSSPropertyValue, waitForElementsComputedSection, waitForPropertyValueInComputedPane} from '../helpers/elements-helpers.js';\n\nasync function goToTestPageAndSelectTestElement(path: string = 'inline_editor/default.html') {\n  await goToResource(path);\n  await waitForContentOfSelectedElementsNode('<body>\\u200B');\n  await clickNthChildOfSelectedElementNode(1);\n  await waitForContentOfSelectedElementsNode('<div id=\\u200B\"inspected\">\\u200BInspected div\\u200B</div>\\u200B');\n}\n\nasync function assertColorSwatch(container: puppeteer.ElementHandle|undefined, expectedColor: string) {\n  if (!container) {\n    assert.fail('Container not found');\n  }\n  const swatch = await getColorSwatch(container, 0);\n  assert.isTrue(Boolean(swatch), 'Color swatch found');\n\n  const color = await getColorSwatchColor(container, 0);\n  assert.strictEqual(color, expectedColor, 'Color swatch has the right color');\n}\n\nasync function assertNoColorSwatch(container: puppeteer.ElementHandle|undefined) {\n  if (!container) {\n    assert.fail('Container not found');\n  }\n  const swatch = await getColorSwatch(container, 0);\n  assert.isUndefined(swatch, 'No color swatch found');\n}\n\ndescribe('The color swatch', async () => {\n  it('is displayed for color properties in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'color', 'red');\n    const property = await getCSSPropertyInRule('#inspected', 'color');\n\n    await assertColorSwatch(property, 'red');\n  });\n\n  it('is displayed for color properties in the Computed pane', async () => {\n    await goToTestPageAndSelectTestElement();\n    await navigateToSidePane('Computed');\n    await waitForElementsComputedSection();\n\n    const property = await getPropertyFromComputedPane('color');\n    await assertColorSwatch(property, 'rgb(255, 0, 0)');\n  });\n\n  it('is not displayed for non-color properties in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'margin', '10px');\n    const property = await getCSSPropertyInRule('#inspected', 'margin');\n\n    await assertNoColorSwatch(property);\n  });\n\n  it('is not displayed for non-color properties that have color-looking values in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'animation-name', 'black');\n    const property = await getCSSPropertyInRule('#inspected', 'animation-name');\n\n    await assertNoColorSwatch(property);\n  });\n\n  it('is not displayed for color properties that have color-looking values in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'background', 'url(red green blue.jpg)');\n    const property = await getCSSPropertyInRule('#inspected', 'background');\n\n    await assertNoColorSwatch(property);\n  });\n\n  it('is displayed for var() functions that compute to colors in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'background-color', 'var(--variable)');\n    const property = await getCSSPropertyInRule('#inspected', 'background-color');\n    await assertColorSwatch(property, 'blue');\n  });\n\n  it('is not displayed for var() functions that have color-looking names but do not compute to colors in the Styles pane',\n     async () => {\n       await goToTestPageAndSelectTestElement();\n\n       await waitForCSSPropertyValue('#inspected', 'border-color', 'var(--red)');\n       const property = await getCSSPropertyInRule('#inspected', 'border-color');\n       await assertNoColorSwatch(property);\n     });\n\n  it('is displayed for color-looking custom properties in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', '--variable', 'blue');\n    const property = await getCSSPropertyInRule('#inspected', '--variable');\n    await assertColorSwatch(property, 'blue');\n  });\n\n  it('supports shift-clicking for color properties in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'color', 'red');\n    const property = await getCSSPropertyInRule('#inspected', 'color');\n    if (!property) {\n      assert.fail('Property not found');\n    }\n    await shiftClickColorSwatch(property, 0);\n\n    await waitForCSSPropertyValue('#inspected', 'color', 'rgb(255 0 0)');\n  });\n\n  it('supports shift-clicking for color properties in the Computed pane', async () => {\n    await goToTestPageAndSelectTestElement();\n    await navigateToSidePane('Computed');\n    await waitForElementsComputedSection();\n\n    const property = await getPropertyFromComputedPane('color');\n    if (!property) {\n      assert.fail('Property not found');\n    }\n\n    await waitForPropertyValueInComputedPane('color', 'rgb(255, 0, 0)');\n    await shiftClickColorSwatch(property, 0);\n    await waitForPropertyValueInComputedPane('color', 'hsl(0deg 100% 50%)');\n  });\n\n  it('supports shift-clicking for colors next to var() functions', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'background-color', 'var(--variable)');\n    const property = await getCSSPropertyInRule('#inspected', 'background-color');\n    if (!property) {\n      assert.fail('Property not found');\n    }\n    await shiftClickColorSwatch(property, 0);\n\n    await waitForCSSPropertyValue('#inspected', 'background-color', 'rgb(0 0 255)');\n  });\n\n  it('is updated when the color value is updated in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement();\n\n    await waitForCSSPropertyValue('#inspected', 'color', 'red');\n    let property = await getCSSPropertyInRule('#inspected', 'color');\n    await assertColorSwatch(property, 'red');\n\n    await editCSSProperty('#inspected', 'color', 'blue');\n\n    await waitForCSSPropertyValue('#inspected', 'color', 'blue');\n    property = await getCSSPropertyInRule('#inspected', 'color');\n    await assertColorSwatch(property, 'blue');\n  });\n\n  it('is updated for a var() function when the customer property value changes in the Styles pane', async () => {\n    await goToTestPageAndSelectTestElement('inline_editor/var-chain.html');\n\n    await waitForCSSPropertyValue('#inspected', '--bar', 'var(--baz)');\n    await waitForCSSPropertyValue('#inspected', 'color', 'var(--bar)');\n\n    let barProperty = await getCSSPropertyInRule('#inspected', '--bar');\n    let colorProperty = await getCSSPropertyInRule('#inspected', 'color');\n    await assertColorSwatch(barProperty, 'red');\n    await assertColorSwatch(colorProperty, 'red');\n\n    await editCSSProperty('#inspected', '--baz', 'blue');\n    await waitForCSSPropertyValue('#inspected', '--baz', 'blue');\n\n    barProperty = await getCSSPropertyInRule('#inspected', '--bar');\n    colorProperty = await getCSSPropertyInRule('#inspected', 'color');\n    await assertColorSwatch(barProperty, 'blue');\n    await assertColorSwatch(colorProperty, 'blue');\n  });\n});\n"]}