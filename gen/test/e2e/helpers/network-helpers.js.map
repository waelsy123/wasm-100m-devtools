{"version":3,"file":"network-helpers.js","sourceRoot":"","sources":["../../../../../../test/e2e/helpers/network-helpers.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {$$, click, getBrowserAndPages, goToResource, setCheckBox, waitFor, waitForFunction} from '../../shared/helper.js';\n\nimport type {puppeteer} from '../../shared/helper.js';\nconst REQUEST_LIST_SELECTOR = '.network-log-grid .data';\n\n/**\n * Select the Network tab in DevTools\n */\nexport async function navigateToNetworkTab(testName: string) {\n  await goToResource(`network/${testName}`);\n  await click('#tab-network');\n  // Make sure the network tab is shown on the screen\n  await waitFor('.network-log-grid');\n}\n\n/**\n * Wait until a certain number of requests are shown in the request list.\n * @param numberOfRequests The expected number of requests to wait for.\n * @param selector Optional. The selector to use to get the list of requests.\n */\nexport async function waitForSomeRequestsToAppear(numberOfRequests: number) {\n  await waitForFunction(async () => {\n    const requests = await getAllRequestNames();\n    return requests.length >= numberOfRequests && Boolean(requests.map(name => name ? name.trim() : '').join(''));\n  });\n}\n\nexport async function getAllRequestNames() {\n  const requests = await $$(REQUEST_LIST_SELECTOR + ' .name-column');\n  return await Promise.all(requests.map(request => request.evaluate(r => r.childNodes[1].textContent)));\n}\n\nexport async function getSelectedRequestName() {\n  const request = await waitFor(REQUEST_LIST_SELECTOR + ' tr.selected .name-column');\n  return await request.evaluate(node => {\n    return node && node.childNodes[1].textContent;\n  });\n}\n\nexport async function selectRequestByName(name: string, clickOptions?: puppeteer.ClickOptions) {\n  const selector = REQUEST_LIST_SELECTOR + ' .name-column';\n  const {frontend} = getBrowserAndPages();\n\n  // Finding he click position is done in a single frontend.evaluate call\n  // to make sure the element still exists after finding the element.\n  // If this were done outside of evaluate code, it would be possible for an\n  // element to be removed from the dom between the $$(.selector) call and the\n  // click(element) call.\n  const rect = await frontend.evaluate((name, selector) => {\n    const elements = document.querySelectorAll(selector);\n    for (const element of elements) {\n      if (element.childNodes[1].textContent === name) {\n        const {left, top, width, height} = element.getBoundingClientRect();\n        return {left, top, width, height};\n      }\n    }\n    return null;\n  }, name, selector);\n\n  if (rect) {\n    const x = rect.left + rect.width * 0.5;\n    const y = rect.top + rect.height * 0.5;\n    await frontend.mouse.click(x, y, clickOptions);\n  }\n}\n\nexport async function waitForSelectedRequestChange(initialRequestName: string|null) {\n  await waitForFunction(async () => {\n    const name = await getSelectedRequestName();\n    return name !== initialRequestName;\n  });\n}\n\nexport async function setPersistLog(persist: boolean) {\n  await setCheckBox('[aria-label=\"Preserve log\"]', persist);\n}\n\nexport async function setCacheDisabled(disabled: boolean): Promise<void> {\n  await setCheckBox('[aria-label=\"Disable cache\"]', disabled);\n}\n"]}