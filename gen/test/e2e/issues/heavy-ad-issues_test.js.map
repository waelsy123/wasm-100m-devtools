{"version":3,"file":"heavy-ad-issues_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/issues/heavy-ad-issues_test.ts"],"names":[],"mappings":";AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;;AAE7B,sDAAkG;AAClG,0EAA8D;AAC9D,oEAA8L;AAE9L,IAAA,8BAAQ,EAAC,gBAAgB,EAAE,KAAK,IAAI,EAAE;IACpC,UAAU,CAAC,KAAK,IAAI,EAAE;QACpB,MAAM,IAAA,wBAAY,EAAC,YAAY,CAAC,CAAC;IACnC,CAAC,CAAC,CAAC;IAEH,IAAA,wBAAE,EAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;QAClD,MAAM,IAAA,uCAAmB,GAAE,CAAC;QAC5B,MAAM,EAAC,QAAQ,EAAC,GAAG,IAAA,8BAAkB,GAAE,CAAC;QACxC,QAAQ,CAAC,QAAQ,CAAC,GAAG,EAAE;YACrB,MAAM,KAAK,GAAG;gBACZ,MAAM,EAAE,cAAc;gBACtB,SAAS,EAAE;oBACT,qBAAqB,EAAE;wBACrB,YAAY,EAAE,gBAAgB;wBAC9B,QAAQ,EAAE,mBAAmB;wBAC7B,OAAO,EAAE,EAAC,OAAO,EAAE,MAAM,EAAC;qBAC3B;iBACF;aACF,CAAC;YACF,aAAa;YACb,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;YAC9B,MAAM,MAAM,GAAG;gBACb,MAAM,EAAE,cAAc;gBACtB,SAAS,EAAE;oBACT,qBAAqB,EAAE;wBACrB,YAAY,EAAE,gBAAgB;wBAC9B,QAAQ,EAAE,cAAc;wBACxB,OAAO,EAAE,EAAC,OAAO,EAAE,MAAM,EAAC;qBAC3B;iBACF;aACF,CAAC;YACF,aAAa;YACb,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QACH,MAAM,IAAA,+BAAW,GAAE,CAAC;QACpB,MAAM,YAAY,GAAG,MAAM,IAAA,mCAAe,EAAC,iDAAiD,CAAC,CAAC;QAC9F,IAAA,oCAAwB,EAAC,YAAY,CAAC,CAAC;QACvC,MAAM,OAAO,GAAG,MAAM,IAAA,uCAAmB,EAAC,aAAa,EAAE,YAAY,CAAC,CAAC;QACvE,MAAM,IAAA,mDAA+B,EAAC,OAAO,CAAC,CAAC;QAC/C,MAAM,iBAAiB,GAAG;YACxB,CAAC,gBAAgB,EAAE,mBAAmB,EAAE,WAAW,CAAC;YACpD,CAAC,eAAe,EAAE,SAAS,EAAE,IAAI,CAAC;YAClC,CAAC,gBAAgB,EAAE,QAAQ,EAAE,IAAI,CAAC;SACnC,CAAC;QACF,MAAM,IAAA,2DAAuC,EAAC,OAAO,CAAC,OAAO,EAAE,iBAAiB,CAAC,CAAC;IACpF,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assertNotNullOrUndefined, getBrowserAndPages, goToResource} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {ensureResourceSectionIsExpanded, expandIssue, getIssueByTitle, getResourcesElement, navigateToIssuesTab, waitForTableFromResourceSectionContents} from '../helpers/issues-helpers.js';\n\ndescribe('Heavy Ad issue', async () => {\n  beforeEach(async () => {\n    await goToResource('empty.html');\n  });\n\n  it('should display correct information', async () => {\n    await navigateToIssuesTab();\n    const {frontend} = getBrowserAndPages();\n    frontend.evaluate(() => {\n      const issue = {\n        'code': 'HeavyAdIssue',\n        'details': {\n          'heavyAdIssueDetails': {\n            'resolution': 'HeavyAdBlocked',\n            'reason': 'NetworkTotalLimit',\n            'frame': {frameId: 'main'},\n          },\n        },\n      };\n      // @ts-ignore\n      window.addIssueForTest(issue);\n      const issue2 = {\n        'code': 'HeavyAdIssue',\n        'details': {\n          'heavyAdIssueDetails': {\n            'resolution': 'HeavyAdWarning',\n            'reason': 'CpuPeakLimit',\n            'frame': {frameId: 'main'},\n          },\n        },\n      };\n      // @ts-ignore\n      window.addIssueForTest(issue2);\n    });\n    await expandIssue();\n    const issueElement = await getIssueByTitle('An ad on your site has exceeded resource limits');\n    assertNotNullOrUndefined(issueElement);\n    const section = await getResourcesElement('2 resources', issueElement);\n    await ensureResourceSectionIsExpanded(section);\n    const expectedTableRows = [\n      ['Limit exceeded', 'Resolution Status', 'Frame URL'],\n      ['Network limit', 'Removed', /.*/],\n      ['CPU peak limit', 'Warned', /.*/],\n    ];\n    await waitForTableFromResourceSectionContents(section.content, expectedTableRows);\n  });\n});\n"]}