{"version":3,"file":"live-edit-moving-breakpoint_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/sources/live-edit-moving-breakpoint_test.ts"],"names":[],"mappings":";AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;;AAE7B,+BAA4B;AAE5B,sDAAkI;AAClI,0EAA8D;AAC9D,sEAAiJ;AAEjJ,IAAA,8BAAQ,EAAC,WAAW,EAAE,KAAK,IAAI,EAAE;IAC/B,IAAA,wBAAE,EAAC,kEAAkE,EAAE,KAAK,IAAI,EAAE;QAChF,MAAM,EAAC,QAAQ,EAAE,MAAM,EAAC,GAAG,IAAA,8BAAkB,GAAE,CAAC;QAChD,MAAM,IAAA,gDAA2B,EAAC,gCAAgC,EAAE,kCAAkC,CAAC,CAAC;QAExG,MAAM,IAAA,gBAAI,EAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YACtD,MAAM,aAAa,GAAG,MAAM,IAAA,mBAAO,EAAC,aAAa,CAAC,CAAC;YACnD,MAAM,UAAU,GAAG,MAAM,IAAA,wBAAY,EAAC,kCAAkC,EAAE,aAAa,CAAC,CAAC;YACzF,IAAA,oCAAwB,EAAC,UAAU,CAAC,CAAC;YAErC,iFAAiF;YACjF,wCAAwC;YACxC,MAAM,IAAA,iBAAK,EAAC,UAAU,CAAC,CAAC;YACxB,MAAM,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAErC,MAAM,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YACvC,MAAM,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,MAAM,IAAA,gBAAI,EAAC,qDAAqD,EAAE,KAAK,IAAI,EAAE;YAC3E,MAAM,IAAA,oBAAQ,EAAC,GAAG,EAAE,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC;YACrC,MAAM,IAAA,mBAAO,EAAC,+CAA+C,CAAC,CAAC;QACjE,CAAC,CAAC,CAAC;QAEH,MAAM,IAAA,gBAAI,EAAC,sCAAsC,EAAE,KAAK,IAAI,EAAE;YAC5D,MAAM,IAAA,yCAAoB,EAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;QAEH,MAAM,IAAA,gBAAI,EAAC,0DAA0D,EAAE,KAAK,IAAI,EAAE;YAChF,MAAM,IAAA,mDAA8B,EAAC,QAAQ,EAAE,MAAM,EAAE,gCAAgC,CAAC,CAAC;YACzF,MAAM,IAAA,gDAA2B,EAAC,gCAAgC,EAAE,kCAAkC,CAAC,CAAC;YAExG,iFAAiF;YACjF,+EAA+E;YAC/E,yBAAyB;YACzB,aAAM,CAAC,MAAM,CAAC,MAAM,IAAA,oCAAe,EAAC,CAAC,CAAC,CAAC,CAAC;YACxC,aAAM,CAAC,OAAO,CAAC,MAAM,IAAA,oCAAe,EAAC,CAAC,CAAC,CAAC,CAAC;QAC3C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2022 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {$textContent, assertNotNullOrUndefined, click, getBrowserAndPages, pressKey, step, waitFor} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {addBreakpointForLine, isBreakpointSet, openSourceCodeEditorForFile, reloadPageAndWaitForSourceFile} from '../helpers/sources-helpers.js';\n\ndescribe('Live edit', async () => {\n  it('moves the breakpoint after reload when changes are not persisted', async () => {\n    const {frontend, target} = getBrowserAndPages();\n    await openSourceCodeEditorForFile('live-edit-moving-breakpoint.js', 'live-edit-moving-breakpoint.html');\n\n    await step('add two newlines to the script', async () => {\n      const editorContent = await waitFor('.cm-content');\n      const markerLine = await $textContent('// Insertion marker for newline.', editorContent);\n      assertNotNullOrUndefined(markerLine);\n\n      // Place the caret at the end of the marker line by clicking in the middle of the\n      // line element and then pressing 'End'.\n      await click(markerLine);\n      await frontend.keyboard.press('End');\n\n      await frontend.keyboard.press('Enter');\n      await frontend.keyboard.press('Enter');\n    });\n\n    await step('save the script and wait for the save to go through', async () => {\n      await pressKey('s', {control: true});\n      await waitFor('[aria-label=\"live-edit-moving-breakpoint.js\"]');\n    });\n\n    await step('set a breakpoint in the \"await\" line', async () => {\n      await addBreakpointForLine(frontend, 9);\n    });\n\n    await step('reload the page and verify that the breakpoint has moved', async () => {\n      await reloadPageAndWaitForSourceFile(frontend, target, 'live-edit-moving-breakpoint.js');\n      await openSourceCodeEditorForFile('live-edit-moving-breakpoint.js', 'live-edit-moving-breakpoint.html');\n\n      // TODO(crbug.com/1216904): Flip this assumption once crbug.com/1216904 is fixed.\n      //     We currently expect the bugged state to make sure the test keeps running\n      //     and is maintained.\n      assert.isTrue(await isBreakpointSet(9));\n      assert.isFalse(await isBreakpointSet(7));\n    });\n  });\n});\n"]}