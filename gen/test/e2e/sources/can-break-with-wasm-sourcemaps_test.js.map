{"version":3,"file":"can-break-with-wasm-sourcemaps_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/sources/can-break-with-wasm-sourcemaps_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {getBrowserAndPages, step, timeout, waitForFunction} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {addBreakpointForLine, checkBreakpointDidNotActivate, isBreakpointSet, openFileInEditor, openSourceCodeEditorForFile, reloadPageAndWaitForSourceFile, retrieveTopCallFrameScriptLocation, retrieveTopCallFrameWithoutResuming, sourceLineNumberSelector} from '../helpers/sources-helpers.js';\n\ndescribe('The Sources Tab', async () => {\n  it('can add breakpoint for a sourcemapped wasm module', async () => {\n    const {target, frontend} = getBrowserAndPages();\n\n    await openSourceCodeEditorForFile('with-sourcemap.ll', 'wasm/wasm-with-sourcemap.html');\n    await addBreakpointForLine(frontend, 5);\n\n    const scriptLocation = await retrieveTopCallFrameScriptLocation('main();', target);\n    assert.deepEqual(scriptLocation, 'with-sourcemap.ll:5');\n  });\n\n  // Flaky on linux bot\n  it.skip('[crbug.com/1252330] hits two breakpoints that are set and activated separately', async function() {\n    const {target, frontend} = getBrowserAndPages();\n    const fileName = 'with-sourcemap.ll';\n\n    await step('navigate to a page and open the Sources tab', async () => {\n      await openSourceCodeEditorForFile(fileName, 'wasm/wasm-with-sourcemap.html');\n    });\n\n    await step('add a breakpoint to line No.5', async () => {\n      await addBreakpointForLine(frontend, 5);\n    });\n\n    await step('reload the page', async () => {\n      await reloadPageAndWaitForSourceFile(frontend, target, fileName);\n    });\n\n    await waitForFunction(async () => await isBreakpointSet(5));\n\n    await step('check that the code has paused on the breakpoint at the correct script location', async () => {\n      const scriptLocation = await retrieveTopCallFrameWithoutResuming();\n      assert.deepEqual(scriptLocation, 'with-sourcemap.ll:5');\n    });\n\n    await step('remove the breakpoint from the fifth line', async () => {\n      await frontend.click(sourceLineNumberSelector(5));\n    });\n\n    await step('reload the page', async () => {\n      await target.reload();\n    });\n\n    // FIXME(crbug/1112692): Refactor test to remove the timeout.\n    await timeout(100);\n\n    await step('open original source file', async () => {\n      await openFileInEditor('with-sourcemap.ll');\n    });\n\n    await waitForFunction(async () => !(await isBreakpointSet(5)));\n    await checkBreakpointDidNotActivate();\n\n    await step('add a breakpoint to line No.6', async () => {\n      await addBreakpointForLine(frontend, 6);\n    });\n\n    await step('reload the page', async () => {\n      await reloadPageAndWaitForSourceFile(frontend, target, fileName);\n    });\n\n    await waitForFunction(async () => await isBreakpointSet(6));\n\n    await step('check that the code has paused on the breakpoint at the correct script location', async () => {\n      const scriptLocation = await retrieveTopCallFrameWithoutResuming();\n      assert.deepEqual(scriptLocation, 'with-sourcemap.ll:6');\n    });\n  });\n});\n"]}