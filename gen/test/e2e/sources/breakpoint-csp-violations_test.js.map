{"version":3,"file":"breakpoint-csp-violations_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/sources/breakpoint-csp-violations_test.ts"],"names":[],"mappings":";AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;;AAE7B,+BAA4B;AAE5B,sDAA2D;AAC3D,0EAA8D;AAC9D,sEAA6G;AAE7G,IAAA,8BAAQ,EAAC,8BAA8B,EAAE,KAAK,IAAI,EAAE;IAClD,IAAA,wBAAE,EAAC,0DAA0D,EAAE,KAAK,IAAI,EAAE;QACxE,MAAM,IAAA,qCAAgB,GAAE,CAAC;QACzB,MAAM,IAAA,iBAAK,EAAC,0CAA0C,CAAC,CAAC;QACxD,MAAM,IAAA,iBAAK,EAAC,wCAAwC,CAAC,CAAC;QACtD,MAAM,IAAA,iBAAK,EAAC,8CAAyB,CAAC,CAAC;QAEvC,MAAM,QAAQ,GAAG,IAAA,wBAAY,EAAC,sDAAsD,CAAC,CAAC;QAEtF,MAAM,OAAO,GAAG,MAAM,IAAA,sCAAiB,GAAE,CAAC;QAC1C,aAAM,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,yBAAyB,CAAC,CAAC;QAClE,aAAM,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,EAAE,+BAA+B,CAAC,CAAC;QAEvE,MAAM,IAAA,iBAAK,EAAC,wCAAwC,CAAC,CAAC;QACtD,MAAM,OAAO,GAAG,MAAM,IAAA,sCAAiB,GAAE,CAAC;QAC1C,aAAM,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,qBAAqB,CAAC,CAAC;QAC9D,aAAM,CAAC,WAAW,CACd,OAAO,CAAC,SAAS,EACjB,6GAA6G,CAAC,CAAC;QAEnH,MAAM,IAAA,iBAAK,EAAC,wCAAwC,CAAC,CAAC;QACtD,MAAM,QAAQ,CAAC;IACjB,CAAC,CAAC,CAAC;IACH,IAAA,wBAAE,EAAC,gDAAgD,EAAE,KAAK,IAAI,EAAE;QAC9D,MAAM,IAAA,qCAAgB,GAAE,CAAC;QACzB,MAAM,IAAA,iBAAK,EAAC,0CAA0C,CAAC,CAAC;QACxD,MAAM,IAAA,iBAAK,EAAC,wCAAwC,CAAC,CAAC;QAEtD,MAAM,QAAQ,GAAG,IAAA,wBAAY,EAAC,yDAAyD,CAAC,CAAC;QAEzF,MAAM,OAAO,GAAG,MAAM,IAAA,sCAAiB,GAAE,CAAC;QAC1C,aAAM,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,yBAAyB,CAAC,CAAC;QAClE,aAAM,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,EAAE,+BAA+B,CAAC,CAAC;QAEvE,MAAM,IAAA,iBAAK,EAAC,wCAAwC,CAAC,CAAC;QACtD,MAAM,OAAO,GAAG,MAAM,IAAA,sCAAiB,GAAE,CAAC;QAC1C,aAAM,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,EAAE,yBAAyB,CAAC,CAAC;QAClE,aAAM,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,EAAE,6BAA6B,CAAC,CAAC;QAErE,MAAM,IAAA,iBAAK,EAAC,wCAAwC,CAAC,CAAC;QACtD,MAAM,QAAQ,CAAC;IACjB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {click, goToResource} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {getPausedMessages, openSourcesPanel, PAUSE_ON_EXCEPTION_BUTTON} from '../helpers/sources-helpers.js';\n\ndescribe('Breakpoints on CSP Violation', async () => {\n  it('CSP Violations should come up before break on exceptions', async () => {\n    await openSourcesPanel();\n    await click('[aria-label=\"CSP Violation Breakpoints\"]');\n    await click('[aria-label=\"Trusted Type Violations\"]');\n    await click(PAUSE_ON_EXCEPTION_BUTTON);\n\n    const resource = goToResource('network/trusted-type-violations-enforced.rawresponse');\n\n    const status1 = await getPausedMessages();\n    assert.strictEqual(status1.statusMain, 'Paused on CSP violation');\n    assert.strictEqual(status1.statusSub, 'Trusted Type Policy Violation');\n\n    await click('[aria-label=\"Resume script execution\"]');\n    const status2 = await getPausedMessages();\n    assert.strictEqual(status2.statusMain, 'Paused on exception');\n    assert.strictEqual(\n        status2.statusSub,\n        'TypeError: Failed to execute \\'createPolicy\\' on \\'TrustedTypePolicyFactory\\': Policy \"policy2\" disallowed.');\n\n    await click('[aria-label=\"Resume script execution\"]');\n    await resource;\n  });\n  it('CSP Violations should show in report-only mode', async () => {\n    await openSourcesPanel();\n    await click('[aria-label=\"CSP Violation Breakpoints\"]');\n    await click('[aria-label=\"Trusted Type Violations\"]');\n\n    const resource = goToResource('network/trusted-type-violations-report-only.rawresponse');\n\n    const status1 = await getPausedMessages();\n    assert.strictEqual(status1.statusMain, 'Paused on CSP violation');\n    assert.strictEqual(status1.statusSub, 'Trusted Type Policy Violation');\n\n    await click('[aria-label=\"Resume script execution\"]');\n    const status2 = await getPausedMessages();\n    assert.strictEqual(status2.statusMain, 'Paused on CSP violation');\n    assert.strictEqual(status2.statusSub, 'Trusted Type Sink Violation');\n\n    await click('[aria-label=\"Resume script execution\"]');\n    await resource;\n  });\n});\n"]}