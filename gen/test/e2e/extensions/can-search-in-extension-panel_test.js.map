{"version":3,"file":"can-search-in-extension-panel_test.js","sourceRoot":"","sources":["../../../../../../test/e2e/extensions/can-search-in-extension-panel_test.ts"],"names":[],"mappings":";AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;;AAE7B,+BAA4B;AAE5B,0EAA8D;AAC9D,0EAA8D;AAC9D,sDAA6G;AAQ7G,MAAM,UAAU,GAAG,WAAW,CAAC;AAC/B,IAAA,8BAAQ,EAAC,kBAAkB,EAAE,KAAK,IAAI,EAAE;IACtC,oCAAoC;IACpC,wBAAE,CAAC,eAAe,CAAC,CAAC,KAAK,CAAC,EAAE,gDAAgD,EAAE,KAAK,IAAI,EAAE;QACvF,MAAM,SAAS,GAAG,MAAM,IAAA,oCAAa,EAAC,eAAe,CAAC,CAAC;QAEvD,MAAM,IAAI,GAAG,IAAI,GAAG,CAAC,GAAG,IAAA,4BAAgB,GAAE,6BAA6B,CAAC,CAAC,QAAQ,CAAC;QAElF,MAAM,SAAS,CAAC,QAAQ,CAAC,KAAK,EAAE,KAAa,EAAE,IAAY,EAAE,EAAE;YAC7D,MAAM,CAAC,YAAY,GAAG,EAAE,CAAC;YACzB,MAAM,KAAK,GAAG,MAAM,IAAI,OAAO,CAC3B,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;YACzE,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,MAAM,EAAE,WAAW,EAAE,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,WAAW,EAAC,CAAC,CAAC,CAAC;QACvG,CAAC,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;QAErB,MAAM,IAAA,iBAAK,EAAC,eAAe,UAAU,GAAG,CAAC,CAAC;QAE1C,MAAM,EAAC,QAAQ,EAAC,GAAG,IAAA,8BAAkB,GAAE,CAAC;QACxC,MAAM,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACxC,MAAM,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACnC,MAAM,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAEtC,MAAM,MAAM,GAAG,MAAM,IAAA,mBAAO,EAAC,qBAAqB,CAAC,CAAC;QACpD,MAAM,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAEzB,MAAM,OAAO,GAAG,MAAM,IAAA,2BAAe,EAAC,GAAG,EAAE;YACzC,OAAO,SAAS,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;QACpG,CAAC,CAAC,CAAC;QAEH,aAAM,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC,EAAC,MAAM,EAAE,eAAe,EAAE,WAAW,EAAE,KAAK,EAAC,CAAC,CAAC,CAAC;IAC7E,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\nimport type {Chrome} from '../../../extension-api/ExtensionAPI.js';\nimport {loadExtension} from '../helpers/extension-helpers.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {click, getBrowserAndPages, getResourcesPath, waitFor, waitForFunction} from '../../shared/helper.js';\n\ndeclare global {\n  interface Window {\n    searchEvents: {action: string, queryString?: string}[];\n  }\n}\n\nconst PAGE_TITLE = 'TestPanel';\ndescribe('Extension panels', async () => {\n  // Test fails a lot on mac currently\n  it.skipOnPlatforms(['mac'], '[crbug.com/1249774] can perform search actions', async () => {\n    const extension = await loadExtension('TestExtension');\n\n    const page = new URL(`${getResourcesPath()}/extensions/test_panel.html`).pathname;\n\n    await extension.evaluate(async (title: string, page: string) => {\n      window.searchEvents = [];\n      const panel = await new Promise<Chrome.DevTools.ExtensionPanel>(\n          r => window.chrome.devtools.panels.create('TestPanel', '', page, r));\n      panel.onSearch.addListener((action, queryString) => window.searchEvents.push({action, queryString}));\n    }, PAGE_TITLE, page);\n\n    await click(`[aria-label=${PAGE_TITLE}]`);\n\n    const {frontend} = getBrowserAndPages();\n    await frontend.keyboard.down('Control');\n    await frontend.keyboard.press('F');\n    await frontend.keyboard.up('Control');\n\n    const search = await waitFor('#search-input-field');\n    await search.type('abc');\n\n    const queries = await waitForFunction(() => {\n      return extension.evaluate(() => window.searchEvents.length > 0 ? window.searchEvents : undefined);\n    });\n\n    assert.deepEqual(queries, [{action: 'performSearch', queryString: 'abc'}]);\n  });\n});\n"]}