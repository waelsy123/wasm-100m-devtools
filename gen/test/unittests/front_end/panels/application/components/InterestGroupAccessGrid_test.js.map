{"version":3,"file":"InterestGroupAccessGrid_test.js","sourceRoot":"","sources":["../../../../../../../../../test/unittests/front_end/panels/application/components/InterestGroupAccessGrid_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Protocol from '../../../../../../front_end/generated/protocol.js';\nimport * as ApplicationComponents from '../../../../../../front_end/panels/application/components/components.js';\nimport * as DataGrid from '../../../../../../front_end/ui/components/data_grid/data_grid.js';\nimport * as Coordinator from '../../../../../../front_end/ui/components/render_coordinator/render_coordinator.js';\nimport {assertElement, assertShadowRoot, getElementWithinComponent, renderElementIntoDOM} from '../../../helpers/DOMHelpers.js';\nimport {describeWithLocale} from '../../../helpers/EnvironmentHelpers.js';\nimport {getValuesOfAllBodyRows} from '../../../ui/components/DataGridHelpers.js';\n\nconst coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n\nconst {assert} = chai;\n\nasync function renderInterestGroupAccessGrid(events: Protocol.Storage.InterestGroupAccessedEvent[]):\n    Promise<ApplicationComponents.InterestGroupAccessGrid.InterestGroupAccessGrid> {\n  const component = new ApplicationComponents.InterestGroupAccessGrid.InterestGroupAccessGrid();\n  renderElementIntoDOM(component);\n  component.data = events;\n\n  // The data-grid's renderer is scheduled, so we need to wait until the coordinator\n  // is done before we can test against it.\n  await coordinator.done();\n\n  return component;\n}\n\nfunction getInternalDataGridShadowRoot(\n    component: ApplicationComponents.InterestGroupAccessGrid.InterestGroupAccessGrid): ShadowRoot {\n  const dataGridController = getElementWithinComponent(\n      component, 'devtools-data-grid-controller', DataGrid.DataGridController.DataGridController);\n  const dataGrid = getElementWithinComponent(dataGridController, 'devtools-data-grid', DataGrid.DataGrid.DataGrid);\n  assertShadowRoot(dataGrid.shadowRoot);\n  return dataGrid.shadowRoot;\n}\n\ndescribeWithLocale('InterestGroupAccessGrid', () => {\n  it('renders interest group access events', async () => {\n    const component = await renderInterestGroupAccessGrid([\n      {\n        accessTime: 0,\n        type: Protocol.Storage.InterestGroupAccessType.Bid,\n        ownerOrigin: 'https://owner1.com',\n        name: 'cars',\n      },\n      {\n        accessTime: 10,\n        type: Protocol.Storage.InterestGroupAccessType.Join,\n        ownerOrigin: 'https://owner2.com',\n        name: 'trucks',\n      },\n    ]);\n\n    const dataGridShadowRoot = getInternalDataGridShadowRoot(component);\n    const rowValues = getValuesOfAllBodyRows(dataGridShadowRoot);\n    const expectedValues = [\n      [(new Date(0 * 1e3)).toLocaleString(), 'bid', 'https://owner1.com', 'cars'],\n      [(new Date(10 * 1e3)).toLocaleString(), 'join', 'https://owner2.com', 'trucks'],\n    ];\n    assert.deepEqual(rowValues, expectedValues);\n  });\n\n  it('hides interest group event table when there are no events', async () => {\n    const component = await renderInterestGroupAccessGrid([]);\n    assertShadowRoot(component.shadowRoot);\n\n    const nullGridElement = component.shadowRoot.querySelector('devtools-data-grid-controller');\n    assert.isNull(nullGridElement);\n\n    const noEventsElement = component.shadowRoot.querySelector('div.no-events-message');\n    assertElement(noEventsElement, HTMLDivElement);\n  });\n});\n"]}